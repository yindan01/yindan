# Generated by Selenium IDE
from time import sleep

from selenium import  webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By


class TestDemo1():
    def setup_method(self, method):
        option=Options()
        #option.debugger_address='127.0.0.1:9222'
        #self.driver = webdriver.Chrome(options=option)
        self.driver=webdriver.Chrome()
        #隐式等待，动态的等待
        self.driver.implicitly_wait(5)

    def teardown_method(self, method):
        self.driver.quit()



    def test_cookie(self):

        self.driver.get("https://work.weixin.qq.com/wework_admin/frame")
        #sleep(20)
        # #get_cookies获取当前页面的cookie
        # cookies=self.driver.get_cookies()
        # print(cookies)
        # 打开index页面，这时候需要denglu
        cookies=[{'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.vst', 'path': '/', 'secure': False, 'value': '7XcBW4kvhxmaU_dNWl4_fuzVWdp46uJtO3TjQ2hLJMmsfOQTTauVmY79867YzRSzXPexD4GJNv4jbQUyTFK6O25WjQlKKStdqAP8xY8D5mdWojQK0k5PGRLKabkdiqlCH5ru8UcShMVUPmw5BE1_UnfoEmjF-yQk8fVPnUhH8cbBTghlJgzhuYBiETI9mD_BUe9R1OglsMilA8y2liZwrMOP9xUQvEnrBZf9ce5uq9SztViciX-org5NYznm0UUrzj0x3S1D__nSzd71zb5cUQ'}, {'domain': '.work.weixin.qq.com', 'httpOnly': False, 'name': 'wxpay.vid', 'path': '/', 'secure': False, 'value': '1688850428771233'}, {'domain': '.work.weixin.qq.com', 'httpOnly': False, 'name': 'wxpay.corpid', 'path': '/', 'secure': False, 'value': '1970325129157820'}, {'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.sid', 'path': '/', 'secure': False, 'value': 'ak8zqxDa75i7Jz2Um7Pumyl_t2p08QMXW_oHjxfUZGvx5KoBKJRmFH75CL8Pnq1f'}, {'domain': 'work.weixin.qq.com', 'expiry': 1598319735, 'httpOnly': True, 'name': 'ww_rtkey', 'path': '/', 'secure': False, 'value': '3otmcel'}, {'domain': '.qq.com', 'expiry': 1598288261, 'httpOnly': False, 'name': '_gat', 'path': '/', 'secure': False, 'value': '1'}, {'domain': '.qq.com', 'expiry': 1661360210, 'httpOnly': False, 'name': '_ga', 'path': '/', 'secure': False, 'value': 'GA1.2.1230555888.1598288202'}, {'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.ltype', 'path': '/', 'secure': False, 'value': '1'}, {'domain': '.work.weixin.qq.com', 'httpOnly': False, 'name': 'wwrtx.d2st', 'path': '/', 'secure': False, 'value': 'a5380677'}, {'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.refid', 'path': '/', 'secure': False, 'value': '30324012633401146'}, {'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.ref', 'path': '/', 'secure': False, 'value': 'direct'}, {'domain': '.work.weixin.qq.com', 'httpOnly': False, 'name': 'wwrtx.vid', 'path': '/', 'secure': False, 'value': '1688850428771233'}, {'domain': '.work.weixin.qq.com', 'expiry': 1629824199, 'httpOnly': False, 'name': 'wwrtx.c_gdpr', 'path': '/', 'secure': False, 'value': '0'}, {'domain': '.qq.com', 'expiry': 1598374610, 'httpOnly': False, 'name': '_gid', 'path': '/', 'secure': False, 'value': 'GA1.2.670712853.1598288202'}, {'domain': '.work.weixin.qq.com', 'expiry': 1600880212, 'httpOnly': False, 'name': 'wwrtx.i18n_lan', 'path': '/', 'secure': False, 'value': 'zh-cn'}]
        #带有登录信息的cookie
        for cookie in cookies:
            if 'expiry' in cookie.keys():
                cookie.pop("expiry")
            self.driver.add_cookie(cookie)
        sleep(20)
            # 重新打开 已带有cookie 信息的index 页面
        self.driver.get("https://work.weixin.qq.com/wework_admin/frame")

        self.driver.find_element(By.CSS_SELECTOR,".index_service_cnt_itemWrap:nth-child(2)").click()
        self.driver.find_element(By.ID,"js_upload_file_input").send_keys("/Users/yindan/Desktop/异界三侠.xlsx")
        assert "mydata.xlsx"==self.driver.find_element(By.ID,'//*[@id="__dialog__MNDialog_1598205472764__"]').text